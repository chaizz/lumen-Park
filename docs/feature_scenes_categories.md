# Lumen Park 场景与分类功能产品设计文档

## 1. 概述 (Overview)

为了帮助用户更精准地查找和筛选富士胶片配方（Recipes），Lumen Park 将引入 **“场景 (Scene)”** 和 **“分类 (Category)”** 的概念。用户可以通过组合不同的环境条件（如光线、地点）和拍摄主题（如人像、风景）来筛选作品。

## 2. 核心概念 (Core Concepts)

本功能采用 **标签化 (Tag-based)** 的设计思路，而不是严格的树状分类。

### 2.1 维度定义

我们将筛选维度分为两类：

1. **环境/光线 (Environment/Lighting)** - 定义“场景”
   * *示例*: 阴天 (Overcast), 晴天 (Sunny), 室内 (Indoor), 夜景 (Night), 黄金时刻 (Golden Hour)
2. **主题/地点 (Subject/Location)** - 定义“分类”
   * *示例*: 人像 (Portrait), 街拍 (Street), 海边 (Seaside), 咖啡厅 (Cafe), 森林 (Forest), 建筑 (Architecture)

### 2.2 组合逻辑

用户可以通过“并集”或“交集”的方式组合标签进行筛选。

* **场景示例**: “阴天” + “海边”
* **场景示例**: “室内” + “人像”

## 3. 功能需求 (Functional Requirements)

### 3.1 投稿端 (Submit Page)

* **新增标签选择器**: 在发布作品页面，新增“场景标签”选择区域。
* **预设标签库**: 系统提供常用的预设标签供用户点选（支持多选，建议限制最多 5 个）。

### 3.2 浏览端 (Home Page)

* **筛选栏 (Filter Bar)**: 在首页顶部（Banner 下方，瀑布流上方）增加一个横向滚动的筛选栏。
* **二级筛选**:
  * 第一级：大类（如：全部、人像、风光、街拍、室内）。
  * 第二级（可选）：点击大类后，可进一步选择细分场景（如：阴天、晴天）。
* **组合筛选**: 提供一个“筛选器”按钮，展开后可同时勾选多个维度的标签（例如同时勾选“阴天”和“咖啡厅”）。

## 4. 数据结构设计 (Data Structure)

### 4.1 数据库模型 (Database Models)

需要新增两个表来管理标签及其与帖子的关系。

#### `tags` 表

| 字段名 | 类型    | 说明                                                        |
| :----- | :------ | :---------------------------------------------------------- |
| id     | UUID    | 主键                                                        |
| name   | String  | 标签名称 (如 "阴天", "人像")                                |
| type   | String  | 标签类型 (Enum: 'lighting', 'subject', 'location', 'other') |
| count  | Integer | 引用次数 (用于热门排序)                                     |

#### `post_tags` 关联表 (Many-to-Many)

| 字段名  | 类型 | 说明             |
| :------ | :--- | :--------------- |
| post_id | UUID | 外键 -> posts.id |
| tag_id  | UUID | 外键 -> tags.id  |

### 4.2 API 接口变更

* `POST /posts/`: 接收 `tags` 列表字段。
* `GET /posts/`: 新增 `tag_ids` 或 `tags` 查询参数，支持数组（例如 `?tags=overcast&tags=portrait`）。
* `GET /tags/`: 获取热门标签列表，用于前端展示筛选器。

## 5. UI/UX 设计草图

### 首页筛选栏

```text
[ 全部 ] [ 人像 ] [ 街拍 ] [ 风光 ] [ 室内 ]  ( 筛选图标 )
```

### 筛选器展开面板

```text
------------------------------------------------
光线:  [ 晴天 ] [ 阴天 ] [ 室内光 ] [ 夜景 ]
地点:  [ 海边 ] [ 咖啡厅 ] [ 街道 ] [ 公园 ]
主题:  [ 人像 ] [ 静物 ] [ 建筑 ] [ 宠物 ]
------------------------------------------------
[ 重置 ]                          [ 确认筛选 ]
------------------------------------------------
```

### 投稿页

```text
标签 (可选，最多5个):
[ + 添加标签 ]
推荐: [ 阴天 ] [ 富士直出 ] [ 人像 ]
```

## 6. 开发计划 (Phases)

1. **Phase 1: 后端基础**
   * 创建 `Tag` 模型和关联表。
   * 实现标签的增删查改逻辑。
   * 更新 Post 创建和查询接口。
2. **Phase 2: 前端投稿**
   * 在投稿页集成标签选择组件。
3. **Phase 3: 前端筛选**
   * 在首页实现标签筛选栏和逻辑。
